# Huntress-Managed-SIEM-Lab
A hands-on laboratory environment focused on Windows Event Log analysis and ES|QL query development within the Huntress Managed SIEM. This project documents the process of identifying, analyzing, and reporting on authentication events and network-based logon failures.

Project Overview
This project documents the creation of a "Victim vs. Attacker" laboratory environment. The goal was to deploy a cloud-based security stack using Huntress Managed SIEM and verify its detection capabilities by simulating a network-based attack from a Kali Linux host.

Core Competencies
Network Architecture: Designing internal subnets and VNet peering in Azure.

Endpoint Security: Deploying SIEM agents via PowerShell.

Offensive/Defensive Correlation: Mapping Kali Linux attack tools to Windows Security Event IDs.

Log Analysis: Utilizing ES|QL to investigate failed authentication patterns.

Phase 1: Multi-Host Environment Setup (Azure)
The lab was built in Microsoft Azure using a two-host architecture to simulate a realistic network environment.

Victim Host: AzureHunt1
Operating System: Windows Server 2025 Datacenter / Windows 11.

Role: Primary telemetry source.

Security: Configured with a Network Security Group (AzureHunt1-nsg) allowing management traffic while monitoring for anomalies.

Attacker Host: Kali Linux
Operating System: Kali Linux.

Internal IP: 172.19.0.4.

Role: Simulated threat actor originating from a peered virtual network (vnet-eastus-3).

Phase 2: Huntress Agent & SIEM Deployment
The Huntress Agent was deployed to the Windows host to bridge the gap between local OS logs and the cloud-based SIEM.

Deployment: Executed via PowerShell; verified through "Huntress Agent successfully installed" script completion.

SIEM Ingestion: Enabled "Organization-Wide Collection" within the Huntress console to automatically ingest Windows Event Logs.

Inventory Management: Confirmed AzureHunt1 was registered and reporting under the SOC_Project organization.

Phase 3: Attack Simulation (Kali to AzureHunt1)
With the SIEM active, I utilized the Kali Linux host to perform a targeted brute-force attack against the Windows environment.

Tooling: Automated credential guessing (e.g., Hydra) targeting the built-in Administrator account.

Attack Vector: Network-based logon attempts (Logon Type 3) across the VNet.

Phase 4: Security Analysis & ES|QL Querying
The final phase involved using the Huntress Managed SIEM to discover and analyze the telemetry generated by the attack.

Detection Results
Using ES|QL, I identified a spike in Event ID 4625 (An account failed to log on).

Query Used: from logs | where event.code == 4625 | stats count() by user.name

Findings:

Source IP: 172.19.0.4 (Attacker Kali Host).

Target Account: Administrator.

Failure Reason: 0xc0000064 â€” The provided username does not exist on the target system.

Conclusion
This lab successfully demonstrated the visibility provided by a Managed SIEM. By simulating an attack from a dedicated Kali instance, I was able to verify that Huntress accurately captures the source IP, the targeted user, and the specific failure sub-status, providing all necessary context for a SOC Analyst to recommend remediation.
